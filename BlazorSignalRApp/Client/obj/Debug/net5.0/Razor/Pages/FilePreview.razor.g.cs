#pragma checksum "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "20d1fada4b038b64aef718091444c08f90a81f41"
// <auto-generated/>
#pragma warning disable 1591
namespace BlazorSignalRApp.Client.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/_Imports.razor"
using BlazorSignalRApp.Client;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/_Imports.razor"
using BlazorSignalRApp.Client.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
using System.IO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/FilePreview")]
    public partial class FilePreview : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, "<h3>File Preview Component</h3>\n\nMax file size:\n<br>\n");
            __builder.OpenElement(1, "input");
            __builder.AddAttribute(2, "type", "number");
            __builder.AddAttribute(3, "id", "max-file-size");
            __builder.AddAttribute(4, "value", Microsoft.AspNetCore.Components.BindConverter.FormatValue(
#nullable restore
#line 9 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                                                      maxFileSize

#line default
#line hidden
#nullable disable
            , culture: global::System.Globalization.CultureInfo.InvariantCulture));
            __builder.AddAttribute(5, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.CreateBinder(this, __value => maxFileSize = __value, maxFileSize, culture: global::System.Globalization.CultureInfo.InvariantCulture));
            __builder.SetUpdatesAttributeName("value");
            __builder.CloseElement();
            __builder.AddMarkupContent(6, "\n<br>\n\nMax allowed files:\n<br>\n");
            __builder.OpenElement(7, "input");
            __builder.AddAttribute(8, "type", "number");
            __builder.AddAttribute(9, "id", "max-allowed-files");
            __builder.AddAttribute(10, "value", Microsoft.AspNetCore.Components.BindConverter.FormatValue(
#nullable restore
#line 14 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                                                          maxAllowedFiles

#line default
#line hidden
#nullable disable
            , culture: global::System.Globalization.CultureInfo.InvariantCulture));
            __builder.AddAttribute(11, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.CreateBinder(this, __value => maxAllowedFiles = __value, maxAllowedFiles, culture: global::System.Globalization.CultureInfo.InvariantCulture));
            __builder.SetUpdatesAttributeName("value");
            __builder.CloseElement();
            __builder.AddMarkupContent(12, "\n<br>\n\n");
            __builder.OpenComponent<Microsoft.AspNetCore.Components.Forms.InputFile>(13);
            __builder.AddAttribute(14, "OnChange", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>(this, 
#nullable restore
#line 17 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                     LoadFiles

#line default
#line hidden
#nullable disable
            )));
            __builder.AddAttribute(15, "id", "input-file");
            __builder.AddAttribute(16, "multiple", true);
            __builder.CloseComponent();
            __builder.AddMarkupContent(17, "\n<br>\n\n");
            __builder.OpenElement(18, "span");
            __builder.AddAttribute(19, "id", "exception-message");
            __builder.AddContent(20, 
#nullable restore
#line 20 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                              exceptionMessage

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 22 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
 if (isLoading)
{

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(21, "<p>Loading...</p>\n    <br>");
#nullable restore
#line 26 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
}

#line default
#line hidden
#nullable disable
#nullable restore
#line 28 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
 foreach (var (file, content) in loadedFiles)
{

#line default
#line hidden
#nullable disable
            __builder.OpenElement(22, "p");
            __builder.AddAttribute(23, "id", "file-" + (
#nullable restore
#line 30 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                  file.Name

#line default
#line hidden
#nullable disable
            ));
            __builder.AddMarkupContent(24, "<strong>Name:</strong> ");
            __builder.OpenElement(25, "span");
            __builder.AddAttribute(26, "id", "file-name");
            __builder.AddContent(27, 
#nullable restore
#line 31 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                                                      file.Name

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(28, "<br>\n        ");
            __builder.AddMarkupContent(29, "<strong>Last modified:</strong> ");
            __builder.OpenElement(30, "span");
            __builder.AddAttribute(31, "id", "file-last-modified");
            __builder.AddContent(32, 
#nullable restore
#line 32 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                                                                        file.LastModified.ToString()

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(33, "<br>\n        ");
            __builder.AddMarkupContent(34, "<strong>Size (bytes):</strong> ");
            __builder.OpenElement(35, "span");
            __builder.AddAttribute(36, "id", "file-size");
            __builder.AddContent(37, 
#nullable restore
#line 33 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                                                              file.Size

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(38, "<br>\n        ");
            __builder.AddMarkupContent(39, "<strong>Content type:</strong> ");
            __builder.OpenElement(40, "span");
            __builder.AddAttribute(41, "id", "file-content-type");
            __builder.AddContent(42, 
#nullable restore
#line 34 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                                                                      file.ContentType

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(43, "<br>\n        ");
            __builder.AddMarkupContent(44, "<strong>Content:</strong> ");
            __builder.OpenElement(45, "span");
            __builder.AddAttribute(46, "id", "file-content");
            __builder.AddContent(47, 
#nullable restore
#line 35 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                                                           content

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(48, "<br>");
            __builder.CloseElement();
#nullable restore
#line 37 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
}

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(49, "<h1>Image upload</h1>\n\n");
            __builder.OpenComponent<Microsoft.AspNetCore.Components.Forms.InputFile>(50);
            __builder.AddAttribute(51, "OnChange", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>(this, 
#nullable restore
#line 41 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                     LoadImage

#line default
#line hidden
#nullable disable
            )));
            __builder.AddAttribute(52, "id", "input-image");
            __builder.CloseComponent();
            __builder.AddMarkupContent(53, "\n<br>");
#nullable restore
#line 44 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
 if (imageDataUri != null)
{

#line default
#line hidden
#nullable disable
            __builder.OpenElement(54, "p");
            __builder.AddMarkupContent(55, "\n        Uploaded image:<br>\n        ");
            __builder.OpenElement(56, "img");
            __builder.AddAttribute(57, "id", "image-uploaded");
            __builder.AddAttribute(58, "src", 
#nullable restore
#line 48 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
                                       imageDataUri

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 50 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
}

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(59, "<p>\n    Source image:<br>\n    <img id=\"image-source\" src=\"images/blazor_logo_1000x.png\"></p>");
        }
        #pragma warning restore 1998
#nullable restore
#line 57 "/Users/Luce/Projects/practice-blazor/BlazorSignalRApp/Client/Pages/FilePreview.razor"
       
    Dictionary<IBrowserFile, string> loadedFiles = new Dictionary<IBrowserFile, string>();

    long maxFileSize = 1024 * 1024 * 15;
    int maxAllowedFiles = 3;

    bool isLoading;

    string imageDataUri;

    string exceptionMessage;

    async Task LoadFiles(InputFileChangeEventArgs e)
    {
        isLoading = true;
        loadedFiles.Clear();
        exceptionMessage = string.Empty;

        try
        {
            foreach (var file in e.GetMultipleFiles(maxAllowedFiles))
            {
                StateHasChanged();

                using var reader = new StreamReader(file.OpenReadStream(maxFileSize));

                loadedFiles.Add(file, await reader.ReadToEndAsync());
            }
        }
        catch (Exception ex)
        {
            exceptionMessage = ex.Message;
        }

        isLoading = false;
    }

    async Task LoadImage(InputFileChangeEventArgs e)
    {
        var format = "image/jpeg";
        var imageFile = await e.File.RequestImageFileAsync(format, 640, 480);

        using var fileStream = imageFile.OpenReadStream(maxFileSize);
        using var memoryStream = new MemoryStream();
        await fileStream.CopyToAsync(memoryStream);

        imageDataUri = $"data:{format};base64,{Convert.ToBase64String(memoryStream.ToArray())}";
    }

#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
